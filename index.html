<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced MBA Attendance Dashboard</title>
    <style>
        :root {
            --primary-color: #007bff;
            --primary-dark: #0056b3;
            --light-grey: #f4f7f9;
            --dark-grey: #6c757d;
            --border-color: #e9ecef;
            --card-bg: #ffffff;
            --text-color: #343a40;
            --header-color: #1c294e;
            --safe-color: #28a745;
            --safe-bg: #e9f7ec;
            --warning-color: #dc3545;
            --warning-bg: #fbebee;
            --info-color: #17a2b8;
            --info-bg: #e7f6f8;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--light-grey);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            width: 100%;
            max-width: 900px;
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            padding: 30px;
            box-sizing: border-box;
        }
        header { text-align: center; margin-bottom: 25px; }
        header h1 { color: var(--header-color); margin-bottom: 5px;}
        header p { color: var(--dark-grey); margin-top: 0; }
        
        .input-section {
            background-color: #f8f9fa; border: 1px solid var(--border-color); border-radius: 8px;
            padding: 20px; margin-bottom: 25px; display: flex; flex-wrap: wrap;
            gap: 20px; align-items: flex-end;
        }
        .input-group { flex: 1; min-width: 200px; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: #555; }
        input[type="number"] {
            width: 100%; padding: 12px; border: 1px solid #ced4da;
            border-radius: 6px; font-size: 16px; box-sizing: border-box;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        input[type="number"]:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25); outline: none; }
        button {
            padding: 12px 20px; border: none; border-radius: 6px; font-size: 16px;
            font-weight: 600; cursor: pointer; transition: background-color 0.2s, transform 0.1s;
        }
        button:active { transform: scale(0.98); }
        .btn-primary { background-color: var(--primary-color); color: white; flex-shrink: 0; }
        .btn-primary:hover { background-color: var(--primary-dark); }
        
        .dashboard { display: none; grid-template-columns: 1fr 1.5fr; gap: 25px; }
        .card { background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; }
        .card h3 { margin-top: 0; border-bottom: 2px solid var(--light-grey); padding-bottom: 10px; margin-bottom: 15px; display:flex; align-items:center; gap: 10px; }

        /* Gauge Infographic */
        .gauge-container { position: relative; width: 200px; height: 100px; margin: 20px auto; overflow: hidden; }
        .gauge-svg { width: 200px; height: 100px; }
        .gauge-back { fill: none; stroke: #eee; stroke-width: 20; }
        .gauge-front { fill: none; stroke: var(--primary-color); stroke-width: 20; stroke-linecap: round; transition: stroke-dashoffset 1s ease-in-out, stroke 1s; }
        .gauge-text { position: absolute; top: 75%; left: 50%; transform: translate(-50%, -50%); font-size: 2.5em; font-weight: 700; color: var(--header-color); }
        .gauge-subtext { text-align: center; font-size: 1em; color: var(--dark-grey); }

        /* Analysis Card */
        .analysis-item { margin-bottom: 15px; }
        .analysis-item strong { color: var(--header-color); }
        .progress-bar { width: 100%; background-color: var(--border-color); border-radius: 5px; height: 10px; overflow: hidden; }
        .progress-bar-inner { height: 100%; background-color: var(--warning-color); border-radius: 5px; transition: width 1s ease-in-out; }
        .insight { background: var(--info-bg); border-left: 4px solid var(--info-color); padding: 15px; border-radius: 4px; margin-top: 20px; font-size: 0.9em; }
        .hidden { display: none !important; }
        
        /* Subject Breakdown */
        .subject-breakdown { display: grid; gap: 10px; }
        .subject-row { display: grid; grid-template-columns: 100px 1fr 50px; align-items: center; gap: 10px; font-size: 0.9em; }
        .subject-bar-container { background-color: var(--light-grey); border-radius: 4px; overflow:hidden; }
        .subject-bar { height: 18px; background-color: var(--primary-color); border-radius: 4px; transition: width 1s ease-in-out; }
        .subject-bar.safe { background-color: var(--safe-color); }
        .subject-bar.warning { background-color: var(--warning-color); }

        /* Calendar and Simulation */
        .calendar-container { text-align: center; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        #monthYear { font-size: 1.2em; font-weight: 600; color: var(--header-color); }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .day-name { font-weight: 600; font-size: 0.9em; color: var(--dark-grey); }
        .calendar-day { padding: 8px 5px; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; margin: auto; cursor: pointer; transition: all 0.2s; }
        .calendar-day:not(.other-month):hover { background-color: #e9ecef; }
        .other-month { color: #adb5bd; cursor: default; }
        .weekend { color: #aaa; }
        .holiday { background-color: var(--info-bg); color: var(--info-color); font-weight: bold; }
        .selected-leave { background-color: var(--primary-color) !important; color: white !important; transform: scale(1.1); }
        #simulationResult { margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; }
        .sim-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid var(--border-color); }
        .sim-row:last-child { border-bottom: none; }
        .sim-label { font-weight: 600; }
        .sim-value.warning { color: var(--warning-color); }
        .sim-value.safe { color: var(--safe-color); }

        .icon { vertical-align: middle; margin-right: 8px; width: 20px; height: 20px; }

        /* --- NEW COPYRIGHT STYLE --- */
        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: var(--dark-grey);
            font-style: italic;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Advanced Attendance Dashboard</h1>
            <p>Your interactive tool for tracking attendance, simulating leaves, and achieving your academic goals.</p>
        </header>
        
        <div class="input-section">
            <div class="input-group">
                <label for="classesHeld">Total Classes Held So Far</label>
                <input type="number" id="classesHeld" placeholder="e.g., 150">
            </div>
            <div class="input-group">
                <label for="classesAttended">Total Classes You Attended</label>
                <input type="number" id="classesAttended" placeholder="e.g., 120">
            </div>
            <button id="calculateBtn" class="btn-primary">Generate Dashboard</button>
        </div>

        <main id="dashboard" class="dashboard">
            <div class="left-column">
                <div class="card">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,12.5A1.5,1.5 0 0,1 10.5,11A1.5,1.5 0 0,1 12,9.5A1.5,1.5 0 0,1 13.5,11A1.5,1.5 0 0,1 12,12.5M17,11.5C17,13.43 14.77,15 12,15C9.23,15 7,13.43 7,11.5C7,9.57 9.23,8 12,8C14.77,8 17,9.57 17,11.5Z" /></svg>
                        Overall Attendance
                    </h3>
                    <div class="gauge-container">
                        <svg class="gauge-svg" viewBox="0 0 100 50">
                            <path class="gauge-back" d="M10 50 A 40 40 0 0 1 90 50" stroke-width="20"></path>
                            <path id="gaugeFront" class="gauge-front" d="M10 50 A 40 40 0 0 1 90 50" stroke-width="20"></path>
                        </svg>
                        <div id="gaugeText" class="gauge-text">-</div>
                    </div>
                    <p id="gaugeSubtext" class="gauge-subtext">-</p>
                </div>
                 <div class="card">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" /></svg>
                        Strategic Analysis
                    </h3>
                    <div id="analysisContent"></div>
                </div>
            </div>

            <div class="right-column">
                <div class="card">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M3,13H11V11H3M3,6V8H21V6M3,18H11V16H3M13,16H21V18H13M13,11H21V13H13M13,6V8H21V6Z" /></svg>
                        Simulated Subject Breakdown
                    </h3>
                    <div id="subjectBreakdown"></div>
                    <small style="display:block; text-align:center; margin-top:10px; color:var(--dark-grey);"><i>*This is an estimation based on your overall percentage.</i></small>
                </div>
                <div class="card">
                     <h3>
                        <svg class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19,19H5V8H19M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M16.53,11.06L15.47,10L10.5,14.97L8.47,12.94L7.41,14L10.5,17.09L16.53,11.06Z" /></svg>
                        Leave & Holiday Planner
                    </h3>
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button id="prevMonthBtn" class="btn-secondary" style="padding: 8px 12px;">◄</button>
                            <h4 id="monthYear"></h4>
                            <button id="nextMonthBtn" class="btn-secondary" style="padding: 8px 12px;">►</button>
                        </div>
                        <div class="calendar-grid">
                            <div class="day-name">S</div><div class="day-name">M</div><div class="day-name">T</div>
                            <div class="day-name">W</div><div class="day-name">T</div><div class="day-name">F</div><div class="day-name">S</div>
                        </div>
                        <div id="calendarGrid" class="calendar-grid"></div>
                    </div>
                    <div id="simulationResult"></div>
                </div>
            </div>
        </main>
        
        <!-- --- NEW COPYRIGHT FOOTER --- -->
        <footer class="copyright">
            <p>&copy; 2025 | Made by Arpit Mishra</p>
        </footer>
    </div>

    <script>
        // --- CONFIGURATION --- //
        const REQUIRED_ATTENDANCE_PERCENT = 75;
        const CLASSES_PER_DAY = { 0: 0, 1: 6, 2: 7, 3: 7, 4: 7, 5: 7, 6: 0 }; // Sun-Sat
        const SUBJECTS = ["Strategic Mgt", "Universal Values", "Int'l Finance", "Counseling Skills", "Marketing Svcs", "Financial Mkts", "Security Analysis", "Business Intel", "SEO"];
        const HOLIDAYS = { '2025-08-09': 'Raksha Bandhan', '2025-08-15': 'Independence Day', '2025-08-16': 'Janmashtami', '2025-10-02': 'Gandhi Jayanti', '2025-10-07': 'Valmiki Jayanti', '2025-10-20': 'Deepawali', '2025-10-21': 'Deepawali', '2025-10-22': 'Deepawali', '2025-10-23': 'Deepawali', '2025-11-05': 'Guru Nanak B\'day', '2025-12-25': 'Christmas' };
        
        // --- STATE --- //
        let currentDate = new Date(2025, 7, 1);
        let selectedLeaveDates = new Set();
        let held = 0, attended = 0;

        // --- DOM ELEMENTS --- //
        const allDomElements = {
            calculateBtn: document.getElementById('calculateBtn'), heldInput: document.getElementById('classesHeld'), attendedInput: document.getElementById('classesAttended'),
            dashboard: document.getElementById('dashboard'), gaugeFront: document.getElementById('gaugeFront'), gaugeText: document.getElementById('gaugeText'),
            gaugeSubtext: document.getElementById('gaugeSubtext'), analysisContent: document.getElementById('analysisContent'), subjectBreakdown: document.getElementById('subjectBreakdown'),
            prevMonthBtn: document.getElementById('prevMonthBtn'), nextMonthBtn: document.getElementById('nextMonthBtn'), monthYearEl: document.getElementById('monthYear'),
            calendarGrid: document.getElementById('calendarGrid'), simulationResult: document.getElementById('simulationResult')
        };
        const gaugeCircumference = 2 * Math.PI * 40 * 0.5; // Half circle

        // --- EVENT LISTENERS --- //
        document.addEventListener('DOMContentLoaded', () => {
            renderCalendar();
            allDomElements.calculateBtn.addEventListener('click', generateDashboard);
            allDomElements.prevMonthBtn.addEventListener('click', () => changeMonth(-1));
            allDomElements.nextMonthBtn.addEventListener('click', () => changeMonth(1));
        });

        // --- CORE FUNCTIONS --- //
        function generateDashboard() {
            held = parseInt(allDomElements.heldInput.value);
            attended = parseInt(allDomElements.attendedInput.value);

            if (isNaN(held) || isNaN(attended) || held < 0 || attended < 0 || attended > held) {
                alert("Please enter valid numbers. Attended classes cannot be more than held.");
                return;
            }
            allDomElements.dashboard.style.display = 'grid';
            updateAllComponents();
        }

        function updateAllComponents() {
            if (held === 0) return;
            const percentage = (attended / held) * 100;
            updateGauge(percentage);
            updateAnalysis(percentage, held, attended);
            updateSubjectBreakdown(percentage);
            updateSimulation();
        }

        function updateGauge(percentage) {
            const offset = gaugeCircumference * (1 - (percentage / 100));
            allDomElements.gaugeFront.style.strokeDasharray = gaugeCircumference;
            allDomElements.gaugeFront.style.strokeDashoffset = offset;
            allDomElements.gaugeFront.style.stroke = percentage >= REQUIRED_ATTENDANCE_PERCENT ? 'var(--safe-color)' : 'var(--warning-color)';
            allDomElements.gaugeText.textContent = `${percentage.toFixed(1)}%`;
            allDomElements.gaugeSubtext.textContent = `${attended} / ${held} Classes`;
        }
        
        function updateAnalysis(percentage, currentHeld, currentAttended) {
            let content = '';
            const avgClassesPerDay = 34 / 5;
            if (percentage >= REQUIRED_ATTENDANCE_PERCENT) {
                const missableClasses = Math.floor(currentAttended / (REQUIRED_ATTENDANCE_PERCENT / 100) - currentHeld);
                content = `
                    <div class="analysis-item" style="color:var(--safe-color); font-weight:bold;">STATUS: SAFE</div>
                    <div class="analysis-item"><strong>Attendance Buffer:</strong> You can miss <strong>${missableClasses}</strong> more classes before dropping to 75%.</div>
                    <div class="analysis-item"><strong>In Practical Terms:</strong> This is roughly equivalent to <strong>${(missableClasses / avgClassesPerDay).toFixed(1)}</strong> full days of leave.</div>
                    <div class="insight"><strong>Tip:</strong> You have a healthy buffer. Use it wisely for emergencies or important events. Don't let your attendance drift down without reason.</div>
                `;
            } else {
                const neededClasses = Math.ceil(((REQUIRED_ATTENDANCE_PERCENT / 100) * currentHeld - currentAttended) / (1 - (REQUIRED_ATTENDANCE_PERCENT / 100)));
                const progressToGoal = (currentAttended * (1 - (REQUIRED_ATTENDANCE_PERCENT/100))) / ( (REQUIRED_ATTENDANCE_PERCENT/100) * currentHeld - currentAttended ) * 100;
                content = `
                    <div class="analysis-item" style="color:var(--warning-color); font-weight:bold;">STATUS: WARNING</div>
                    <div class="analysis-item"><strong>Attendance Deficit:</strong> You must attend the next <strong>${neededClasses}</strong> classes without absence to reach 75%.</div>
                    <div class="analysis-item"><strong>Recovery Time:</strong> This will take approximately <strong>${(neededClasses / avgClassesPerDay).toFixed(1)}</strong> full days of classes.</div>
                    <div class="analysis-item"><strong>Progress to 75%:</strong> <div class="progress-bar"><div class="progress-bar-inner" style="width:${Math.min(100, progressToGoal)}%;"></div></div></div>
                    <div class="insight"><strong>Tip:</strong> Prioritize attending every class. Each full day of attendance (~7 classes) will significantly help close this gap.</div>
                `;
            }
            allDomElements.analysisContent.innerHTML = content;
        }

        function updateSubjectBreakdown(overallPercentage) {
            let content = '';
            SUBJECTS.forEach(subject => {
                const variation = (Math.random() - 0.5) * 10; // +/- 5% variation
                let subjectPercent = Math.max(0, Math.min(100, overallPercentage + variation));
                const barClass = subjectPercent >= REQUIRED_ATTENDANCE_PERCENT ? 'safe' : 'warning';
                content += `
                    <div class="subject-row">
                        <span>${subject}</span>
                        <div class="subject-bar-container"><div class="subject-bar ${barClass}" style="width:${subjectPercent}%;"></div></div>
                        <strong class="${barClass}">${subjectPercent.toFixed(0)}%</strong>
                    </div>
                `;
            });
            allDomElements.subjectBreakdown.innerHTML = content;
        }
        
        function renderCalendar() {
            allDomElements.calendarGrid.innerHTML = '';
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            allDomElements.monthYearEl.textContent = `${currentDate.toLocaleString('default', { month: 'long' })} ${year}`;
            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let i = 0; i < firstDayOfMonth; i++) allDomElements.calendarGrid.insertAdjacentHTML('beforeend', `<div class="calendar-day other-month"></div>`);
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayOfWeek = new Date(year, month, day).getDay();
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                dayEl.textContent = day;
                dayEl.dataset.date = dateStr;
                if (dayOfWeek === 0 || dayOfWeek === 6) dayEl.classList.add('weekend');
                if (HOLIDAYS[dateStr]) dayEl.classList.add('holiday');
                if (selectedLeaveDates.has(dateStr)) dayEl.classList.add('selected-leave');
                dayEl.addEventListener('click', handleDateClick);
                allDomElements.calendarGrid.appendChild(dayEl);
            }
        }

        function handleDateClick(event) {
            const dateStr = event.target.dataset.date;
            if (!dateStr || allDomElements.dashboard.style.display !== 'grid') {
                 if (allDomElements.dashboard.style.display !== 'grid') alert('Please generate the dashboard first!');
                 return;
            }
            if (selectedLeaveDates.has(dateStr)) selectedLeaveDates.delete(dateStr);
            else selectedLeaveDates.add(dateStr);
            event.target.classList.toggle('selected-leave');
            updateSimulation();
        }

        function changeMonth(offset) {
            currentDate.setMonth(currentDate.getMonth() + offset);
            renderCalendar();
        }

        function updateSimulation() {
            if (held === 0) {
                allDomElements.simulationResult.innerHTML = `<p><em>Update your current attendance first to run a simulation.</em></p>`;
                return;
            }
            let missedClasses = 0, workingLeaveDays = 0;
            selectedLeaveDates.forEach(dateStr => {
                const dayOfWeek = new Date(dateStr).getDay();
                if (dayOfWeek !== 0 && dayOfWeek !== 6 && !HOLIDAYS[dateStr]) {
                    missedClasses += CLASSES_PER_DAY[dayOfWeek];
                    workingLeaveDays++;
                }
            });

            if (selectedLeaveDates.size === 0) {
                allDomElements.simulationResult.innerHTML = `<p><em>Click on calendar dates to plan a leave.</em></p>`;
                return;
            }

            const newHeld = held + missedClasses;
            const newPercentage = (newHeld === 0) ? 0 : (attended / newHeld) * 100;
            const oldPercentage = (attended / held) * 100;
            const statusClass = newPercentage >= REQUIRED_ATTENDANCE_PERCENT ? 'safe' : 'warning';
            
            allDomElements.simulationResult.innerHTML = `
                <div class="sim-row">
                    <span class="sim-label">Working Leave Days</span>
                    <span class="sim-value">${workingLeaveDays}</span>
                </div>
                <div class="sim-row">
                    <span class="sim-label">Classes Missed</span>
                    <span class="sim-value">${missedClasses}</span>
                </div>
                <div class="sim-row">
                    <span class="sim-label">Attendance Before</span>
                    <span class="sim-value">${oldPercentage.toFixed(2)}%</span>
                </div>
                <div class="sim-row">
                    <span class="sim-label">Attendance After</span>
                    <span class="sim-value ${statusClass}" style="font-weight:bold;">${newPercentage.toFixed(2)}%</span>
                </div>
            `;
        }
    </script>
</body>
</html>
